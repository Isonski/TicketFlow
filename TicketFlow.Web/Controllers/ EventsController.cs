using Microsoft.AspNetCore.Mvc;
using TicketFlow.Services.Interfaces;
using TicketFlow.Data.Models;

namespace TicketFlow.Web.Controllers { public class EventsController : Controller { private readonly IEventService eventService; public EventsController(IEventService eventService) { this.eventService = eventService; } public async Task<IActionResult> Index() { var events = await eventService.GetAllEventsAsync(); return View(events); } public IActionResult Create() { return View(); } [HttpPost] public async Task<IActionResult> Create(Event model) { if (!ModelState.IsValid) { return View(model); } await eventService.CreateEventAsync(model); return RedirectToAction(nameof(Index)); } public async Task<IActionResult> Edit(int id) { var ev = await eventService.GetEventByIdAsync(id); if (ev == null) { return NotFound(); } return View(ev); } [HttpPost] public async Task<IActionResult> Edit(Event model) { if (!ModelState.IsValid) { return View(model); } await eventService.UpdateEventAsync(model); return RedirectToAction(nameof(Index)); } public async Task<IActionResult> Delete(int id) { var ev = await eventService.GetEventByIdAsync(id); if (ev == null) { return NotFound(); } return View(ev); } [HttpPost] public async Task<IActionResult> DeleteConfirmed(int id) { await eventService.DeleteEventAsync(id); return RedirectToAction(nameof(Index)); } } }